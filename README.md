
# EMaxim

**EMaxim** is a python-c++ package for verifying the reparameterization property of the general Markov model according to which it is possible to obtain the same log-likelihood score at any location of the root given a topology. The experimental phylogenetic topology and DNA sequences generated by Randall and colleagues is used to verify the reparameterization property.

Randall RN, Radford CE, Roof KA, Natarajan DK, Gaucher EA. 
An experimental phylogeny to benchmark ancestral sequence reconstruction.
_Nature Communications_ 2016 Sep 15;7:12847.
https://pubmed.ncbi.nlm.nih.gov/27628687/

The main functions made available are 

1. Expectation-Maximization (EM) for the Barry-Hartrigan (GMM) using a fixed topology. Methodology is described in the following preprint.

Prabhav Kalaghatgi.
Phylogeny inference under the general Markov model using MST-backbone.
_bioRxiv_ 2020.06.30.180315.
https://doi.org/10.1101/2020.06.30.180315

2. Given a GMM defined on a topology rooted at some node, start EM at alternate internal nodes of topology using reparameterized GMM. Methodology is described in the following paper 

Steel MA, Sz√©kely LA, Hendy MD. Reconstructing trees when sequence sites evolve at variable rates.
_Journal of Computational Biology_ 1994 Summer;1(2):153-63.
https://pubmed.ncbi.nlm.nih.gov/8790461/

3. Generate flower plots visualizing change in log likelihood score, with each petal representing GMM's root location:

a) Log likelihood obtained using initial parameters, and final parameters after convergence of EM.
b) Expected complete-data log likelihood computed after first and final iteration of EM

---

## Features

- **C++ backend** for performing Expectation-Maximization.
- **Python bindings** via [pybind11](https://pybind11.readthedocs.io/).
- Visualization utilities of log-likelihood results.
- Easy installation with `pip`.
